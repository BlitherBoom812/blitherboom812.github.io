---
title: Speech-SP
katex: true
date: 2024-02-28 19:24:02
tags:
---
## è¯­éŸ³ä¿¡å·çš„çº¿æ€§é¢„æµ‹ç¼–ç æŠ€æœ¯

çº¿æ€§é¢„æµ‹ç¼–ç æŠ€æœ¯ï¼ˆç»´çº³æ»¤æ³¢ï¼‰ã€‚å¯ä»¥å‚è€ƒéš”å£ç»Ÿè®¡ä¿¡å·å¤„ç†çš„ç¬”è®°hhã€‚

ç»´çº³æ»¤æ³¢çš„æ­£äº¤åŸç†ï¼š

$$
E \langle x(n-k), e(n) \rangle = 0
$$

æ­£äº¤åŸç†å¯ä»¥ç”¨æ¥ä¼°è®¡ä»»ä½•æ—¶å€™çš„ä»»ä½•å€¼ï¼Œä¸ç®¡æ˜¯ç°åœ¨ï¼ˆæ»¤æ³¢ï¼‰ï¼Œè¿‡å»ï¼ˆå¹³æ»‘ï¼‰è¿˜æ˜¯æœªæ¥ï¼ˆé¢„æµ‹ï¼‰ï¼Œä¹Ÿä¸ç®¡ä¼°è®¡çš„å¯¹è±¡æ˜¯ $x,y$ï¼Œä¸Šè¿°å…¬å¼çš„å«ä¹‰æ˜¯ï¼šä¼°è®¡è¯¯å·®å§‹ç»ˆä¸å·²çŸ¥ä¿¡å·å‚ç›´ï¼Œä¸ä¼°è®¡çš„æ˜¯å“ªä¸ªæ—¶é—´çš„ä¿¡å·æ— å…³ã€‚

åˆ©ç”¨å‰é¢çš„ $P$ ä¸ªä¿¡å·é¢„æµ‹ä¸‹ä¸€ä¸ªä¿¡å·ï¼š

$$
\hat{s}(n)=-\sum_{i=1}^{P^{\prime}}\hat{\alpha}_i\cdot s(n-i)
$$

è¯¯å·®å®šä¹‰ä¸º

$$
\begin{aligned}
\varepsilon(n)& =s(n)-\overset{\wedge}{\operatorname*{s}}(n)=s(n)+\sum_{i=1}\widehat{\alpha}_i\cdot s(n-i)  \\
&=\sum_{i=0}^{P^{\prime}}\widehat{\alpha}_i\cdot s(n-i)
\end{aligned}
$$

ä» z åŸŸçœ‹ï¼Œè¿™æ˜¯ä¸€ä¸ªå…¨æç‚¹æ¨¡å‹äº§ç”Ÿäº†ç›®æ ‡ä¿¡å·ï¼š

$$
S(z) = -S(z)\sum\limits_{i=1}^{P}\alpha_iz^{-i} + E(z)
$$

æ¥ä¸‹æ¥çš„æ‰€æœ‰æ­¥éª¤ï¼Œç›®çš„éƒ½æ˜¯æ¨å¯¼ $\alpha$ çš„å–å€¼ã€‚

### è‡ªç›¸å…³æ³•

æœ¬æ–‡ä¸­å‡è®¾ä¿¡å·å…·æœ‰éå†æ€§ï¼Œå³æ—¶é—´å¹³å‡ç­‰äºç»Ÿè®¡å¹³å‡ï¼Œæ—¶é—´ä¸Šçš„è‡ªç›¸å…³ç­‰äºç»Ÿè®¡æ„ä¹‰ä¸Šçš„è‡ªç›¸å…³ã€‚

åˆ©ç”¨ LMMSE å‡†åˆ™å¯ä»¥æ¨å‡º

$$
\begin{bmatrix}R(0)&R(1)&R(2)&\cdots&R(P-1)\\R(1)&R(0)&R(1)&\cdots&R(P-2)\\R(2)&R(1)&R(0)&\cdots&R(P-3)\\\vdots&\vdots&&&\vdots\\R(P-1)&R(P-2)&\cdots&\cdots&R(0)\end{bmatrix}\cdot\begin{bmatrix}\hat\alpha_1\\\hat\alpha_2\\\vdots\\\vdots\\\hat\alpha_P\end{bmatrix}=-\begin{bmatrix}R(1)\\R(2)\\\vdots\\\vdots\\R(P)\end{bmatrix}
$$

ä¸€ä¸ªä¾‹å­ï¼šDurbin é€’æ¨ç®—æ³•

### åæ–¹å·®æ³•

ä¸èƒ½ä¿è¯å£°ç å™¨ç¨³å®š

### Durbin é€’æ¨ç®—æ³•

#### æ»¤æ³¢å™¨çš„å†…ç§¯

å®šä¹‰$s_w(n)$å…³äº$F(z)$å’Œ$G(z)$çš„å†…ç§¯å¦‚ä¸‹ï¼š

$$
\langle F(z),G(z)\rangle=\sum_{-\infty}^{+\infty}u(n)\cdot v(n)
$$

ç‰¹åˆ«åœ°è‹¥è¿™é‡Œçš„$F(z),\quad G(z)$éƒ½ç”¨æˆ‘ä»¬çš„é€†æ»¤æ³¢å™¨$A(z)=\sum_{i=0}^P\alpha_iZ^{-i}$æ›¿æ¢ï¼Œé‚£ä¹ˆè¯­éŸ³ä¿¡å·$s_w(n)$ç»è¿‡$A(z)$åçš„è¾“å‡º$e(n)$å°±æ˜¯é¢„æµ‹è¯¯å·®ã€‚

$\alpha_i\cdot s_W(n-i)$ å› æ­¤$A(z)$èŒƒæ•°$\|A(z)\|$çš„å¹³æ–¹å°±æ˜¯é¢„æµ‹è¯¯å·®ã€‚å³

$$
\|A(z)\|^2=\langle A(z),A(z)\rangle=\sum_{-\infty}^{+\infty}e(n)\cdot e(n)=\sum_{-\infty}^{+\infty}e^2(n)
$$

å†…ç§¯æœ‰æ­£å®šæ€§ï¼Œçº¿æ€§ï¼Œä¸‰è§’ä¸ç­‰å¼

ç‰¹æ®Šæ€§è´¨ï¼š

$$
\langle z^{-i}, z^{-j} \rangle = R(|i - j|)\\
\langle F(z), G(z) \rangle = \sum\limits_{i=0}^{M}\sum\limits_{j=0}^{M}f_ig_jR(|i - j|)\\
\langle F(z),G(z)\rangle=\left\langle z^kF(z),z^kG(z)\right\rangle\\
\langle F(z),G(z)\rangle=\langle F(1/z),G(1/z)\rangle
$$

#### é€†æ»¤æ³¢å™¨

å®šä¹‰FIRæ»¤æ³¢å™¨$\hat{A}(z)$:

$$
\hat{A}(z)=\sum_{i=0}^P\hat{\alpha}_iz^{-i}\quad,\quad\alpha_0=1
$$

è‹¥$\hat{\alpha}_{i}$æ˜¯æ»¡è¶³LPCæ­£åˆ™æ–¹ç¨‹çš„è§£ï¼Œåˆ™ç§°$\hat{A}(z)$ç§°ä¸ºé€†æ»¤æ³¢å™¨ã€‚$\hat{E}(z)=\hat{A}(z)\cdot S(z)$æ˜¯é¢„æµ‹è¯¯å·®$\varepsilon(n)$çš„z å˜æ¢ã€‚æ˜¾ç„¶æœ‰ï¼š

 (1) è‹¥s(n)æ˜¯ç”±å…¨æç‚¹æ¨¡å‹$1/A(z)$äº§ç”Ÿçš„ï¼Œè¿™æ—¶$A(z)=\sum_{i=0}^P\alpha_iz^{-i}$, å³ï¼š

$s(n)=-\sum_{i=1}^P\alpha_is(n-i)+Ge(n)$

$$
S(z) \cdot A(z) = G \cdot E(z)
$$

#### å‰å‘å’Œåå‘é¢„æµ‹

å‰å‘çº¿æ€§é¢„æµ‹å™¨(Pé˜¶)

$$
\hat{s}(n)=-\sum_{i=1}^P\alpha_i^{(P)}\cdot s(n-i)
$$

å‰å‘é¢„æµ‹è¯¯å·®(Pé˜¶)

$$
\varepsilon_\alpha^{(P)}(n)=s(n)-\hat{s}(n)=\sum_{i=0}^P\alpha_i^{(P)}\cdot s(n-i)\:,\alpha_0^{(P)}=1
$$

å‰å‘é€†æ»¤æ³¢å™¨(Pé˜¶)

$$
A^{(P)}(z)=\sum_{i=0}^P\alpha_i^{(P)}z^{-i}
$$

æ˜¾ç„¶æœ‰

$$
E^{(P)}_\alpha(z) = S(z) \cdot A^{(P)}(z)
$$

åå‘çº¿æ€§é¢„æµ‹å™¨(Pé˜¶)

$$
\hat{s}(n-P-1)=-\sum_{i=1}^P\beta_i^{(P)}\cdot s(n-i)
$$

næ—¶åˆ»å¯¹$s(n-P-1)$çš„åå‘é¢„æµ‹è¯¯å·®(Pé˜¶)

$$
\begin{aligned}&\varepsilon_{\beta}^{(P)}(n)=s(n-P-1)-\hat{s}(n-P-1)\\&=\sum_{i=1}^{P+1}\beta_i^{(P)}\cdot s(n-i)\quad,\quad\beta_{P+1}^{(P)}=1\end{aligned}
$$

åå‘é€†æ»¤æ³¢å™¨ (Pé˜¶)

$$
B^{(P)}(z)=\sum_{i=1}^{P+1}\beta_i^{(P)}z^{-i}
$$

æ˜¾ç„¶æœ‰

$$
E_\beta^{(P)}(z) = S(z) \cdot B^{(P)}(z)
$$

#### æ­£äº¤æ€§åŸç†

åˆ¤å®šæœ€ä½³é¢„æµ‹å™¨çš„å……è¦æ¡ä»¶æ˜¯

$$
\langle A^{(m)}(z), z^{-l} \rangle = 0\\
\langle B^{(m)}(z), z^{-l} \rangle = 0\\
l = 1, 2, \dots, m
$$

ä¸€ä¸ªä¸ä¸¥è°¨çš„ç†è§£ï¼š

$$
u(n) = s(n) * Z^{-1}[A(z)] = \varepsilon(n)\\
v(n) = s(n) * Z^{-1}[z^{-l}] = s(n - l)\\
\begin{align*}
    &\langle A^{(m)}(z), z^{-l} \rangle\\
    =&\sum\limits_{n=-\infty}^{\infty}u(n)v(n)\\
    =&\sum\limits_{n=-\infty}^{\infty}\varepsilon(n)s(n - l)\\
\end{align*}
$$

ç”±äºæ—¶é—´å¹³å‡ç­‰äºç»Ÿè®¡å¹³å‡ï¼Œ

$$
\frac1{2N} \sum\limits_{n=-N}^{N - 1}\varepsilon(n)s(n-l) = E \langle \varepsilon(n), s(n-l) \rangle
$$

æ ¹æ®å¼€å¤´æåˆ°çš„ç»´çº³æ»¤æ³¢æ­£äº¤åŸç†å¯çŸ¥ä¸Šå¼ç­‰äº0ã€‚

#### é€’æ¨å…¬å¼

æ ¹æ®å®šä¹‰ï¼Œå½“$m=0$æ—¶ï¼Œæ˜¾ç„¶æœ‰

$$
A^{(0)}(z)=1\\B^{(0)}(z)=z^{-1}
$$

$m>0$æ—¶æœ‰å¦‚ä¸‹é€’æ¨å…¬å¼ï¼ˆæ–½å¯†ç‰¹æ­£äº¤åŒ–ï¼‰

$$
A^{(m)}(z)=A^{(m-1)}(z)+K^{(m)}B^{(m-1)}(z)
$$

$$
B^{(m)}(z)=z^{-1}\Big[B^{(m-1)}(z)+K^{(m)}A^{(m-1)}(z)\Big]
$$

$$
K^{(m)} = -\frac{\langle A^{(m-1)}(z), B^{(m-1)}(z)\rangle}{||B^{(m-1)}(z)||^2}
$$

æ ¹æ®æ­£äº¤æ€§åŸç†ï¼Œéœ€è¦è¯æ˜ç”±é€’æ¨å…¬å¼å¾—åˆ°çš„$A^{(m)}(z)$å’Œ$B^{(m)}(z)$æ»¡è¶³æ­£äº¤æ€§æ¡ä»¶å…¬å¼ã€‚

 åœ¨å…¬å¼(76) ä¸­ï¼Œæ ¹æ®å¤šé¡¹å¼å¯¹åº”é¡¹ç³»æ•°ç›¸ç­‰çš„åŸåˆ™ï¼Œå¯ä»¥å¾—åˆ°

$$
\begin{aligned}&\alpha_{i}^{(m)}=\alpha_{i}^{(m-1)}+K^{(m)}\cdot\beta_{i}^{(m-1)}\quad,\quad i=1,\cdots,m-1\\&\alpha_{i}^{(m)}=K^{(m)}\quad,\quad i=m\end{aligned}
$$

ç”±å…¬å¼(73)å¯çŸ¥

$$
\beta_j^{(m)}=\alpha_{m+1-j}^{(m)},\:j=1,\cdots,m+1
$$

> ä»è¿™é‡Œå¯ä»¥æ¨å‡º
>
> $$
> B^{(m)}(z) = z^{-(m+1)}A^{(m)}(1/z)
> $$

å› æ­¤å¯ä»¥å¾—åˆ°é¢„æµ‹å™¨ç³»æ•°çš„é€’æ¨å…¬å¼

$$
\begin{cases}\alpha_\mathrm{m}^{(\mathrm{m})}=\mathrm{K}^{(\mathrm{m})}\\\alpha_\mathrm{i}^{(\mathrm{m})}=\alpha_\mathrm{i}^{(\mathrm{m}-1)}+\mathrm{K}^{(\mathrm{m})}\cdot\alpha_\mathrm{m-i}^{(\mathrm{m}-1)}\quad,\:\mathrm{i}=1,\cdots,\mathrm{m}-1\end{cases}
$$

è¿™æ˜¯çº¿æ€§é¢„æµ‹ç³»æ•°çš„Durbiné€’æ¨ç®—æ³•å…¬å¼ã€‚$m$é˜¶éƒ¨åˆ†ç›¸å…³ç³»æ•°$K^{(m)}$å¯ä»¥ç”¨ä»¥ä¸‹æ–¹æ³•è®¡ç®—ï¼š

$$
K^{(m)} = -\frac{\sum\limits_{j=1}^{m}\alpha_{m-j}^{(m-1)}R(j)}{||B^{(m-1)}(z)||^2}
$$

$||B^{(m)}(z)||^2$ å¯ä»¥ç”¨è¿™ä¸ªé€’æ¨å¼è®¡ç®—ï¼š

$$
\begin{Vmatrix}B^{(m)}(z)\end{Vmatrix}^2=(1-[K^{(m)}]^2)\begin{Vmatrix}B^{(m-1)}(z)\end{Vmatrix}^2
$$

åˆå€¼

$$
||B^{(0)}(z)|| = R(0)\\
\alpha^{(0)}_0 = 1
$$

### Durbin ç®—æ³•ç³»ç»Ÿçš„ç¨³å®šæ€§

å……åˆ†æ€§ï¼š

$$
\frac{1}{A^{(m)}(z)} ç¨³å®š \Rarr |k^{(m)}| < 1
$$

å¿…è¦æ€§ï¼š

$$
|k^{(m)}| < 1 \Rarr \frac{1}{A^{(m)}(z)} ç¨³å®š
$$

Highlight:

Durbin é€†åºé€’æ¨å…¬å¼

$$
A^{(m-1)}(z)=\frac{A^{(m)}(z)-k^{(m)}zB^{(m)}(z)}{1-(k^{(m)})^2}
$$

è¯æ˜è¿‡ç¨‹ä¸­å¼•å…¥çš„ä¸€ä¸ªè¾…åŠ©å‡½æ•°

$$
F^{(m)}(z)=\frac{A^{(m)}(z)}{zB^{(m)}(z)}=\frac{z^mA^{(m)}(z)}{A^{(m)}(1/z)}
$$

æ»¡è¶³ $F^{(m)}(z) < 1 \lrArr |z| < 1$

#### ç¨³å®šæ€§çš„åº”ç”¨

å……åˆ†æ€§ï¼šè¯´æ˜ä½¿ç”¨ Durbin ç®—æ³•å¯ä»¥ä¿è¯ $1/A(z)$ ç¨³å®š

å¿…è¦æ€§ï¼š

åˆ¤å®šé«˜é˜¶å¤šé¡¹å¼ $A(z)$ æ„æˆçš„ç³»ç»Ÿ $1/A(z)$ æ˜¯å¦ç¨³å®šã€‚

åªè¦è®¡ç®—å‡º $k_m$ï¼Œåˆ¤æ–­ $|k_m|$ æ˜¯å¦å°äº1å³å¯ã€‚

### LPC æ¨¡å‹å‚æ•°è®¨è®º

#### é˜¶æ•°

è¯¯å·®èƒ½é‡æ˜¯å•è°ƒå‡çš„ï¼Œä¸€èˆ¬ $P = 8 \sim 14$

#### æ¿€åŠ±å¢ç›Š G

é‡‡ç”¨ç¼“å˜çª—ï¼ˆå“ˆæ˜çª—ï¼‰ï¼Œ$N >> P$

$$
\varepsilon_\alpha^{(p)}(n)\approx Ge_w(n)=Ge(n)w(n)
$$

$$
G^2\approx\frac{\sum_{n=-\infty}^\infty\left(\varepsilon_\alpha^{(p)}(n)\right)^2}{\sum_{n=-\infty}^\infty e^2(n)w^2(n)}
$$

#### çŸ­æ—¶åˆ†æå¯¹äºLPCå‚æ•°ä¼°è®¡çš„å½±å“

1. ğ‘’(ğ‘›)ä¸ºç™½å™ªå£°æ—¶ï¼Œ$E[\hat \alpha_i] = \alpha_i$ï¼Œæ— åä¼°è®¡
2. ğ‘’(ğ‘›)ä¸ºæµŠéŸ³æ—¶ï¼Œé‡‡ç”¨åŸºéŸ³åŒæ­¥ç®—æ³•å¯ä»¥è¾¾åˆ°æ— åä¼°è®¡ã€‚å¦åˆ™å¦‚æœæ˜¯ä»»æ„æˆªå–ä¸€æ®µè¯­éŸ³ä½œåˆ†æä¼°è®¡æ˜¯æœ‰åçš„ã€‚

#### LPCåˆ†æçš„é¢‘åŸŸè§£é‡Š

ç”¨LPCåˆ†æå¯ä»¥ç”¨æ¥è·Ÿè¸ªå£°é“æ¨¡å‹è°±ï¼ˆæˆ–ç§°è¯­éŸ³çš„å¹³æ»‘è°±ï¼‰ã€‚è‹¥ç”¨LPCç®—æ³•è§£å‡ºçš„å…¨æç‚¹æ¨¡å‹æ¥é€¼è¿‘å®é™…å£°é“ï¼Œåˆ™å®ƒçš„å•ä½å†²æ¿€å“åº”â„(ğ‘›)ä¸ºï¼š

$$
\begin{cases}
    h(n) = 0, n \lt 0\\
    h(n) = - \sum\limits_{i=1}^{p}\alpha_i^{(p)}h(n - 1) + \delta(n), n \ge 0
\end{cases}
$$

è‹¥ $R_h(l) = R_h(-l) = \sum\limits_{n=0}^{\infty}h(n - l)h(n), l \ge 0$

$$
\sum\limits_{i=1}^{p}\alpha_i^{(P)}R_h(|k - i|) = -R_h(k), l \ge 0\\
R_h(l)/R_h(0) = R(l) / R(0)
$$

å½“æ¿€åŠ±ä¸ºå‡æ–¹å€¼ä¸º1ï¼Œå‡å€¼ä¸º0çš„ç™½å™ªå£°åºåˆ—æ—¶ï¼Œè¾“å‡ºçš„è‡ªå…³å‡½æ•°ğ‘…ğ‘¤(ğ‘™)ä¹Ÿæœ‰æ­¤å…³ç³»ã€‚
Pé˜¶LPCé¢„æµ‹æ¨¡å‹ä¹Ÿç§°ä¸ºPé˜¶è‡ªå…³åŒ¹é…æ¨¡å‹ã€‚

#### å„ç§LPCå‚æ•°è®¡ç®—å…¶å®ƒä»¬ä¹‹é—´çš„å…³ç³»

1. $R(l) \Rightarrow \alpha$
2. $K \Rightarrow \alpha$

$$
\begin{cases}\alpha_m^m=K^{(m)}\\\alpha_i^{(m)}=\alpha_i^{(m-1)}+K^{(m)}\alpha_{m-i}^{(m-1)}\end{cases}
$$

3. LPC ç³»æ•° => å€’è°±ï¼ˆå› ä¸ºæ˜¯æœ€å°ç›¸ä½åºåˆ—ï¼‰
4. PARCOR ç³»æ•°($K^{(m)}$)
   1. ç”± Durbin è§£å¾—
   2. ç”±æ ¼å½¢ç®—æ³•è§£å¾—
   3. ç”± Schur ç®—æ³•è§£å¾—
5. ç”± $A(z)$ æ ¹ç¡®å®šæŒ¯å³°
   1. æ¯ä¸€å¯¹æ ¹ä¸ä¸€ä¸ªå…±æŒ¯å³°å¯¹åº”
6. å£°é“é¢ç§¯æ¯”ç³»æ•°å’Œå¯¹æ•°é¢ç§¯æ¯”ç³»æ•°

$$
\frac{A_m}{A_{m-1}}=\frac{1-K^{(m)}}{1+K^{(m)}}\:,\:m=1,2,\cdots P\\
g_m = \ln\Bigg[\frac{A_m}{A_{m-1}}\Bigg]
$$

7. çº¿è°±å¯¹ï¼ˆLSPï¼‰æˆ–è€…çº¿è°±é¢‘ç‡å‚æ•°(LSF)

$$
P(z) = A^{(p)}(z) + z^{-(p+1)}A^{(p)}(z^{-1})\\
Q(z) = A^{(p)}(z) - z^{-(p+1)}A^{(p)}(z^{-1})
$$

æ€§è´¨ï¼š

1. $P(z)$ å’Œ $Q(z)$ çš„æ ¹å‡åœ¨å•ä½åœ†ä¸Š
2. $P(z)$ å’Œ $Q(z)$ çš„æ ¹åœ¨å•ä½å…ƒä¸Šäº¤é”™
3. $\alpha$ å‚æ•°å’Œ $LSP$ å‚æ•°äº’æ¨

æŸä¸ªç‰¹å®šçš„ğ¿ğ‘†ğ‘ƒ [ğ‘“1, ğ‘“2, â‹¯ ğ‘“ğ‘]ä¸­åªç§»åŠ¨å…¶ä¸­ä»»æ„ä¸€ä¸ªé¢‘ç‡ğ‘“ğ‘–çš„ä½ç½®ï¼Œé‚£ä¹ˆå¯¹åº”çš„å¹³æ»‘è°±åª
æœ‰ğ‘“ğ‘–é™„è¿‘ä¸åŸå¹³æ»‘è°±æœ‰å¼‚ï¼Œè€Œåœ¨å…¶å®ƒé¢‘åŸŸåˆ™å˜åŒ–å¾ˆå°

## è¯­éŸ³ä¿¡å·ç¼–ç 

### è¯­éŸ³ä¿¡å·çš„æ ‡é‡é‡åŒ–

#### æ ‡é‡é‡åŒ–å™¨

#### å‡åŒ€é‡åŒ–å™¨

#### éå‡åŒ€é‡åŒ–å™¨

#### éçº¿æ€§å‹æ‰©é‡åŒ–å™¨

### è‡ªé€‚åº”é‡åŒ–ï¼ˆAdaptive Delta Modulationï¼ŒADMï¼‰

#### å‰å‘è‡ªé€‚åº”é‡åŒ–ï¼ˆAQFï¼‰

#### åå‘è‡ªé€‚åº”é‡åŒ–ï¼ˆAQBï¼‰

### å·®åˆ†ç¼–ç  DPCM

![1713960093567](../images/Speech-SP/1713960093567.png)

DPCMæ˜¯æŒ‡é‡‡ç”¨å›ºå®šé¢„æµ‹å™¨ä¸å›ºå®šé‡åŒ–å™¨çš„å·®å€¼è„‰å†²è°ƒåˆ¶ã€‚

### CVSD ç¼–ç å™¨

![1713958735363](../images/Speech-SP/1713958735363.png)

### Delta-Sigma é‡åŒ–å™¨

![1713958768829](../images/Speech-SP/1713958768829.png)

è€ƒè™‘ $D/A$ å˜æ¢å™¨çš„å¢ç›Šä¸º 1 çš„æƒ…å†µï¼Œæ­¤æ—¶ $V_a(z)\approx V(z)$ï¼Œ

$$
\begin{gathered}
V(z)=[U(z)-V(z)]\cdot H(z)+Q(z) \\
[1+H(z)]\cdot V(z)=U(z)\cdot H(z)+Q(z) \\
V(z)=\frac{H(z)}{1+H(z)}U(z)\cdot+\frac{1}{1+H(z)}Q(z) 
\end{gathered}
$$

å®šä¹‰ä¿¡å·ä¼ è¾“å‡½æ•°

$$
STF(z)=\frac{V(z)}{U(z)}\Bigg|_{Q(z)=0}=\frac{H(z)}{1+H(z)}
$$

å®šä¹‰è¶…å–æ ·é‡åŒ–å™ªå£°ä¼ è¾“å‡½æ•°

$$
NTF(z)=\frac{V(z)}{Q(z)}\Bigg|_{U(z)=0}=\frac{1}{1+H(z)}
$$

è®© $H(z)$ ä¸ºä½é€šï¼Œåˆ™ $STF(z)$ æ˜¯ä½é€šï¼Œ$NTF(z)$ æ˜¯é«˜é€š

$$
V(z)=STF(z)\cdot U(z)+NTF(z)\cdot Q(z)
$$

å™ªå£°æ•´å½¢ï¼ˆNoise-Shapingï¼‰æŠ€æœ¯ï¼š$NTF(z)$ å»æ‰äº†å™ªå£°èƒ½é‡çš„ä½é¢‘éƒ¨åˆ†ã€‚æ¥ä¸‹æ¥ï¼Œåªè¦ç»è¿‡ä½é€šæ»¤æ³¢å™¨ $H_d(z)$ï¼Œå°±å¯ä»¥æ»¤é™¤é«˜é¢‘éƒ¨åˆ†çš„å™ªå£°èƒ½é‡ï¼Œå‰©ä¸‹çš„åªæœ‰æ‰€éœ€è¦çš„ä¿¡å· $U(z)$ï¼Œ$H_d(z)$ çš„è¾“å‡º $V_d(z)$ çš„é‡åŒ–å™ªå£°å¯ä»¥å°äºç›´æ¥ç”¨ A/D é‡åŒ–å™¨é‡åŒ–çš„å™ªå£°ã€‚

é‡‡ç”¨é€Ÿåº¦ï¼ˆè¶…é‡‡æ ·ï¼‰æ¢ç²¾åº¦ï¼ˆé«˜é‡åŒ–æ¯”ç‰¹æ•°ï¼‰ï¼Œé‡åŒ–å™¨çš„ç²¾åº¦å¯ä»¥éå¸¸ä½ï¼Œç”šè‡³å¯ä»¥ç”¨ 1 bit é‡åŒ–å™¨ã€‚1 bit é‡åŒ–å™¨ï¼Œå°±ä¸å­˜åœ¨ A/D éçº¿æ€§é—®é¢˜ã€‚

è¶…é‡‡æ ·çš„å¥½å¤„ï¼šæ‰©å±•äº†é¢‘å¸¦å®½åº¦ï¼Œæˆ‘ä»¬è®¤ä¸ºå™ªå£°çš„åŠŸç‡ä¸€å®šï¼Œå½“é¢‘å¸¦å˜å®½ï¼Œå™ªå£°åŠŸç‡è°±çš„é«˜åº¦å°±é™ä½äº†ã€‚

![1713960064882](../images/Speech-SP/1713960064882.png)

### å­å¸¦ç¼–ç 

å«æœ‰å¤šä¸ªé¢‘ç‚¹ä¿¡å·åˆ†é‡çš„å¤åˆå®½å¸¦ä¿¡å·

é¦–å…ˆç”¨ä¸€ç»„æ»¤æ³¢å™¨å°†ä¿¡å·åˆ†è§£æˆè‹¥å¹²å­å¸¦ä¿¡å·

$$
\langle f_1(t),f_2(t)\rangle=\frac1{2\pi}\cdot\langle F_1(\omega),F_2(\omega)\rangle
$$

è‹¥ $\langle F_1(\omega),F_2(\omega)\rangle\approx0$ï¼Œåˆ™é‡‡ç”¨å­å¸¦æ»¤æ³¢åï¼Œä¸¤ä¸ªä¿¡å·çš„ç›¸å…³æ€§ $\langle f_1(t),f_2(t)\rangle$ é™ä½ï¼Œå¯¹äºè¿™äº›ä¸ç›¸å…³çš„å­å¸¦ä¿¡å·ç‹¬ç«‹ç¼–ç å¯èƒ½æé«˜ç¼–ç æ•ˆç‡ã€‚

#### æ¯”ç‰¹æ•°åˆ†é…

$$
\sum_{k=1}^MR_k=R\\
\sigma_{r_k}^2=\varepsilon_{*k}^2\cdot2^{-2R_k}\cdot\sigma_{x_k}^2\\

\min_{R_k} \sigma_{r,SBC}^2=\sum_{k=1}^M\varepsilon_{*k}^2\cdot2^{-2R_k}\cdot\sigma_{xk}^2\\
$$

è§£å¾—

$$
R_{k,opt}=R/M+\frac12\log_2\frac{\sigma_{x_k}^2}{\left[\prod_{i=1}^M\sigma_{x_i}^2\right]^{1/M}}\\
\sigma_{r_k}^2=\varepsilon_{*k}^2\cdot2^{-2R/M}\cdot\left[\prod_{i=1}^M\sigma_{x_i}^2\right]^{1/M}\\
min\{\sigma_{r,SBC}^2\}=M\cdot\varepsilon_*^2\cdot2^{-\frac{2R}{M}}\cdot\left[\prod_{i=1}^M\sigma_{x_i}^2\right]^{\frac{1}{M}}
$$

æ¯ä¸ªå­å¸¦çš„é‡‡æ ·ç‡å˜ä¸ºæ€»å¸¦å®½çš„ 1/Mï¼Œæ€»çš„ä¿¡æ¯æ¯”ç‰¹é€Ÿç‡ä¸º $R \cdot f/M$ï¼Œä¸ºäº†ä¸ PCM è¿›è¡Œæ¯”è¾ƒï¼Œå‡è®¾ SBC å’Œ PCM çš„ç¼–ç é€Ÿç‡ç›¸ç­‰ï¼š

$$
R_{PCM} \cdot f = R_{SBC} \cdot f / M\\
\Rarr R_{PCM} = R_{SBC}/M
$$

æ­¤æ—¶å¯æ¨å‡º SBC è¾ƒäº PCM çš„ä¿¡å™ªæ¯”å¢ç›Šä¸º

$$
max\{G_{SBC}\}=\frac{\sigma_{r,PCM}^{2}}{\sigma_{r,SBC}^{2}}=\frac{2^{-2R_{PCM}}\sigma_{x}^{2}}{M\cdot2^{-\frac{2R_{SBC}}{M}}\cdot[\prod_{k=1}^{M}\sigma_{xk}^{2}]^{\frac{1}{M}}}\\=\frac{2^{-\frac{2R_{SBC}}{M}}\sigma_{x}^{2}}{M\cdot2^{-\frac{2R_{SBC}}{M}}\cdot[\prod_{k=1}^{M}\sigma_{xk}^{2}]^{\frac{1}{M}}}=\frac{\sigma_{x}^{2}}{M\cdot[\prod_{k=1}^{M}\sigma_{xk}^{2}]^{\frac{1}{M}}}\\=\frac{\frac{1}{M}\sigma_{x}^{2}}{[\prod_{k=1}^{M}\sigma_{xk}^{2}]^{1/M}}=\frac{\frac{1}{M}\sum_{k=1}^{M}\sigma_{xk}^{2}}{[\prod_{k=1}^{M}\sigma_{xk}^{2}]^{1/M}}
$$

å› æ­¤ SBC çš„ä¿¡å™ªæ¯”å¢ç›Šç­‰äºå­å¸¦ä¿¡å·çš„ç®—æœ¯å¹³å‡å’Œå‡ ä½•å¹³å‡ä¹‹æ¯”ã€‚

* å­å¸¦ä¿¡å·èƒ½é‡è¶Šå¤§ï¼Œåˆ™åˆ†é…æ¯”ç‰¹æ•°è¶Šå¤šï¼›
* æœ€ä½³åˆ†é…æ¡ä»¶ä¸‹ï¼Œå„ä¸ªå­å¸¦çš„é‡åŒ–å™ªå£°ç›¸åŒï¼›
* è‹¥å„ä¸ªå­å¸¦èƒ½é‡ç›¸åŒï¼Œåˆ™å­å¸¦ç¼–ç çš„å¢ç›Šä¸º1

#### å¤šç›¸æ­£äº¤æ»¤æ³¢å™¨ç»„

ç”¨ä¸€ç»„ä¸åŒé¢‘ç‡çš„ä½™å¼¦ä¿¡å·å¯¹ä½é€šæ»¤æ³¢å™¨è¿›è¡Œè°ƒåˆ¶ï¼Œå˜æˆäº†å¸¦é€šæ»¤æ³¢å™¨ç»„ï¼š

$$
H_i(z)=\sum_{n=-\infty}^{+\infty}h(n)\cdot cos\left(\pi(2i+1)\cdot\frac{n}{2M}\right)\cdot z^{-n}=\frac12F_i(z)+\frac12G_i(z)
$$

$$
F_{i}\big(e^{j\omega}\big)=H(e^{j(\omega-\frac{\pi(2i+1)}{2M})}),\quad i=0,1,\cdots M-1\\G_{i}\big(e^{j\omega}\big)=H(e^{j(\omega+\frac{\pi(2i+1)}{2M})}),\quad i=0,1,\cdots M-1
$$

![1713963786950](../images/Speech-SP/1713963786950.png)

åˆ†ææ»¤æ³¢å™¨ï¼šå­å¸¦æ»¤æ³¢ï¼Œé™é‡‡æ ·ï¼›

é™é‡‡æ ·ç‡è¿‡ç¨‹ç­‰ä»·äºï¼šé‡‡æ ·(b, å°†éMå€æ•°çš„é‡‡æ ·ç‚¹ç½®ä¸º0) + åˆ†é¢‘(cï¼ŒæŠ½å– M å€æ•°ä¸Šçš„é‡‡æ ·ç‚¹å½¢æˆæ–°çš„ä¿¡å·)

![1713963998639](../images/Speech-SP/1713963998639.png)

$$
\hat{X}_i(z)=\frac1M\sum_{l=0}^{M-1}X_i(z^{\frac1M}W_M^{-l})
$$

![1713965424496](../images/Speech-SP/1713965424496.png)

æ¯ä¸ªå­å¸¦çš„è¾“å‡ºä¼šäº§ç”Ÿå››ç§æ··å å¹²æ‰°ï¼š

$$
\begin{aligned}
U_i(e^{j\omega})& =K_i(e^{j\omega})\cdot Y_i(e^{j\omega})  \\
&\approx\frac1MK_i(e^{j\omega})\{a_iF_i(e^{j\omega})X(e^{j\omega})+b_iG_i(e^{j\omega})X(e^{j\omega})+ \\
&a_iF_i(e^{j(\omega+\frac{2\pi}M\cdot i)})X(e^{j(\omega+\frac{2\pi}M\cdot i)})+b_iG_i(e^{j(\omega-\frac{2\pi}M\cdot i)})X(e^{j(\omega-\frac{2\pi}M\cdot i)})+ \\
&a_iF_i(e^{j(\omega+\frac{2\pi}M\cdot(i+1))})X(e^{j(\omega+\frac{2\pi}M\cdot(i+1))})+b_iG_i(e^{j(\omega-\frac{2\pi}M\cdot(i+1))})X(e^{j(\omega-\frac{2\pi}M\cdot(i+1))})\} \\
&i=1\sim M-2
\end{aligned}
$$

ä¸ºäº†è§£å†³å‡é‡‡æ ·åçš„é¢‘è°±æ··å ï¼Œåœ¨ç»¼åˆæ»¤æ³¢å™¨éƒ¨åˆ†ç²¾ç¡®å¯¹æ¶ˆæ··å ä¿¡å·ï¼š

$$
a_id_i=-a_{i-1}d_{i-1},\quad i>0
$$

### å˜æ¢åŸŸç¼–ç 

æ­£äº¤å˜æ¢åç¼–ç ï¼š

$$
Y = AX
$$

æ­£äº¤å˜æ¢æ»¡è¶³èƒ½é‡å®ˆæ’

$$
||Y||^2 = ||X||^2
$$

é‡å»ºä¿¡å·çš„è¯¯å·®ç­‰äºå˜æ¢åŸŸä¸Šé‡åŒ–å™¨çš„è¯¯å·®

$$
E = Y - [Y]\\
||X - [x]||^2 = ||E||^2
$$

#### æ¯”ç‰¹åˆ†é…

å‡è®¾ N ä¸ªè¾“å…¥æ ·æœ¬ç»„æˆä¸€ä¸ªçŸ¢é‡ Xï¼Œå˜æ¢åŸŸ Y çš„æ¯ä¸ªåˆ†é‡ç”¨ $R_k$  ä¸ªæ¯”ç‰¹é‡åŒ–

$$
R=\frac1N\sum_{k=0}^{N-1}R_k\\
\sigma_q^2=\sum_{k=0}^{N-1}\sigma_{q,k}^2=\varepsilon_*^2\cdot\sum_{k=0}^{N-1}2^{-2R_k}\sigma_k^2\\
\min \sigma_{q}^{2}=\frac{1}{N}\sum_{k=0}^{N-1}\sigma_{q,k}^{2}
$$

$$
R_{k,opt}=R+\frac12\log_2\frac{\sigma_{x_k}^2}{\left[\prod_{i=1}^M\sigma_{x_i}^2\right]^{1/N}}\\
\sigma_{q}^2 = min\{\sigma_{q,k}^2\}=\varepsilon_*^2\cdot2^{-2R}\cdot\left[\prod_{i=1}^M\sigma_{x_i}^2\right]^{\frac{1}{N}}
$$

ç›¸æ¯” PCM çš„å¢ç›Šä¸º

$$
\begin{gathered}
G_{TC} =\frac{min\{\sigma_{r,PCM}^{2}\}}{min\{\sigma_{r,TC}^{2}\}}=\frac{\varepsilon_{*}\cdot2^{-2R}\cdot\sigma_{\chi}^{2}}{\varepsilon_{*}\cdot2^{-2R}\cdot\prod_{k=0}^{N-1}[\sigma_{k}^{2}]^{\frac{1}{N}}} \\
=\frac{\sigma_x^2}{\prod_{k=0}^{N-1}[\sigma_k^2]^{1/N}}=\frac{\frac1N\sum_{k=0}^{N-1}\sigma_k^2}{\prod_{k=0}^{N-1}[\sigma_k^2]^{1/N}} 
\end{gathered}
$$

#### æœ€ä½³æ­£äº¤å˜æ¢ - KL å˜æ¢


## è¯­éŸ³ä¿¡å·çš„å‚æ•°ç¼–ç 

### æ„Ÿè§‰åŠ æƒæ»¤æ³¢å™¨

è¯¯å·®å‡½æ•°åŠ æƒï¼š

$$
J=\int_0^{f_s}\lvert s(f)-\hat{s}(f)\rvert^2\cdot\lvert w(f)\rvert^2df
$$

å…¶ä¸­ï¼ŒåŠ æƒæ»¤æ³¢å™¨æ»¡è¶³

$$
\int_0^{f_S}|w(f)|df= Const.
$$

å½“è¯¯å·®å‡½æ•°æœ€å°çš„æ—¶å€™ï¼Œåº”å½“ä¿è¯

$$
|s(f)-\hat{s}(f)|^2\cdot|w(f)|=\frac{\gamma}{2}=\text{å¸¸æ•°}
$$

å¯ä»¥é€‰æ‹©å¦‚ä¸‹çš„æ»¤æ³¢å™¨ï¼š

$$
w(z)=\frac{A(z)}{A\left(\frac{z}{\gamma}\right)}=\frac{1-\sum_{i=1}^P\alpha_iz^{-i}}{1-\sum_{i=1}^P\alpha_i\gamma^iz^{-i}},\quad0\leq\gamma\leq1
$$

$\gamma$ ä¸ºåŠ æƒå› å­ï¼Œåœ¨ 0-1 ä¹‹é—´ã€‚

$\gamma=0$ æ—¶å˜æˆé€†æ»¤æ³¢å™¨ï¼Œå…¶é¢‘è°±åŒ…ç»œçš„å³°å€¼ç‚¹å°±æ˜¯è¯­éŸ³è°±çš„è°·å€¼ç‚¹ã€‚

>  åˆ†æï¼šè¯­éŸ³ä¿¡å·æ˜¯å…¨æç‚¹æ¨¡å‹äº§ç”Ÿçš„ï¼Œå³ $S(z) = GE(z)/A(z)$ï¼Œä¸é€†æ»¤æ³¢å™¨ç‚¹é¢‘è°±æˆåæ¯”ã€‚

![1715172645812](../images/Speech-SP/1715172645812.png)

### å¤šè„‰å†²æ¿€åŠ±çº¿æ€§é¢„æµ‹å£°ç å™¨

![1715172680511](../images/Speech-SP/1715172680511.png)

è¯­éŸ³ç»¼åˆå™¨çš„æ¿€åŠ±æºæœ‰è‹¥å¹²ä¸ªä¸åŒä½ç½®å’Œå¹…åº¦çš„è„‰å†²ä¿¡å·ç»„æˆã€‚

$$
\hat{s}(n)=\hat{s}_0(n)+\sum_{k=1}^Mg_kh(n-n_k)
$$

å…¶ä¸­ $\hat s_0(n)$ æ˜¯ LPC ç»¼åˆå™¨çš„é›¶è¾“å…¥å“åº”ã€‚

$$
\begin{aligned}&e_{s}(n)=s(n)-\hat{s}(n)=s(n)-\hat{s}_{0}(n)-\sum_{k=1}^{M}g_{k}h(n-n_{k})\\&=\bar{e}(n)-\sum_{k=1}^Mg_kh(n-n_k)\end{aligned}
$$

ç”¨ $\bar{e}(n)=s(n)-\hat{s}_0(n)$ è¡¨ç¤ºè¾“å…¥è¯­éŸ³å‡å»é›¶è¾“å…¥å“åº”ï¼ˆå—å†å²æ¿€åŠ±å½±å“çš„éƒ¨åˆ†ï¼‰ã€‚

è¾“å…¥æ„Ÿè§‰åŠ æƒæ»¤æ³¢å™¨ï¼Œå¾—åˆ°è¾“å‡º

$$
\begin{aligned}e(n)&=e_{s}(n)*w(n)=\left[\bar{e}(n)-\sum_{k=1}^{M}g_{k}h(n-n_{k})\right]*w(n)\\&=\bar{e}_{w}(n)-\sum_{k=1}^{M}g_{k}h_{w}(n-n_{k})\end{aligned}
$$

ä»è€Œï¼Œå¾—åˆ°æ„Ÿè§‰åŠ æƒæ»¤æ³¢å™¨çš„è¯¯å·®å‡½æ•°

$$
E=\sum_{n=1}^Ne^2(n)=\sum_{n=1}^N\left[\bar{e}_w(n)-\sum_{k=1}^Mg_kh_w(n-n_k)\right]^2
$$

é€‰æ‹©åˆé€‚çš„ $n_k$, $g_k$ ä½¿å¾—ä¸Šé¢çš„è¯¯å·®å‡½æ•°æœ€å°

$$
\frac{\partial E}{\partial n_j}=0,\quad j=1,\cdots M\\\frac{\partial E}{\partial g_j}=0,\quad j=1,\cdots M
$$

ä¸Šé¢é‚£ä¸ªæ–¹ç¨‹å¾ˆå¤æ‚ï¼Œä¼šå¯¼å‡ºéçº¿æ€§çš„æ–¹ç¨‹ï¼›

ä»ä¸‹é¢çš„é‚£ä¸ªæ–¹ç¨‹å¯ä»¥æ¨å‡º

$$
\sum_{k=1}^Mg_kR_{hh}(n_k,n_j)=R_{eh}(n_j),\quad j=1,\cdots M
$$

å…¶ä¸­

$$
R_{eh}(n_j)=\sum_{n=1}^N\bar{e}_w(n)\cdot h_w(n-n_j)\\R_{hh}(n_k,n_j)=\sum_{n=1}^Nh_w(n-n_k)h_w(n-n_j)
$$

æ­¤æ—¶å¯æ”¹å†™æœ€å°å‡æ–¹è¯¯å·®

$$
E_{min}=\sum_{n=1}^N[\bar{e}_w(n)]^2-\sum_{k=1}^Mg_kR_{eh}(n_k)
$$

æœ€ä¼˜è§£çš„è®¡ç®—æ¶‰åŠåˆ°éçº¿æ€§æ–¹ç¨‹çš„æ±‚è§£ï¼Œä¸å¤ªç°å®ã€‚è€ƒè™‘é‡‡ç”¨æ¬¡ä¼˜æœç´¢ï¼Œä¸€ä¸ªä¸€ä¸ªæ±‚è§£ã€‚

å½“åªæœ‰ä¸€ä¸ªè„‰å†²æ—¶

$$
g_1R_{hh}(n_1,n_1)=R_{eh}(n_1)\\
E_{min}=\sum_{n=1}^N[\bar{e}_w(n)]^2-g_1R_{eh}(n_1)
$$

æ¶ˆå…ƒå¾—åˆ°

$$
E_{min}=\sum_{n=1}^N[\bar{e}_w(n)]^2-R_{eh}^2(n_1)/R_{hh}(n_1,n_1)
$$

æ¥ä¸‹æ¥æœç´¢ $n_1$ ä½¿å¾—ä¸Šå¼æœ€ä¼˜åŒ–ã€‚è§£å‡º $n_1$ åå³å¯è§£å‡º $g_1$ã€‚

æ¥ä¸‹æ¥ä¸€ä¸ªä¸ªæ±‚è§£ï¼Œæ¯æ¬¡éƒ½è¦æŠŠå‰é¢æ±‚è§£è¿‡çš„è„‰å†²æŠ˜ç®—åˆ°é›¶è¾“å…¥å“åº”ä¸­ï¼Œç„¶åæ±‚è§£å½“å‰çš„ç»“æœï¼š
